version: "3"
services:
  node:
    build: .
    image: kademlia
    command: ["./build/out.o"]
    networks:
      - kademlia_network

  test:
    build: .
    image: kademlia
    volumes:
      - ./coverage:/srv/node/coverage
    command: sh -c "go test -coverprofile cover.out ./... ; 
      go tool cover -html=cover.out -o coverage/cover.html"


networks:
  kademlia_network:
    driver: bridge
